@inject Services.IPlayersLoader pl;
@inject Services.IProvincesLoader pr;
@inject Services.IActionWriter Actions;
@inject Services.IActivePlayer active;
@inject Services.IMap map;

@{
    var queue = Actions.Where(x => x is Dynamics.Actions.Move || x is Dynamics.Actions.PortRenewal);
    (_, var players, var provinces) = queue.EndOfTurn(pl, pr.Provinces, active.Id);
}

<Map Width="1000" Height="1000" Shapes="@map.Shapes" Provinces="@provinces" Mountains="@map.Mountains" FontSize="9"/>